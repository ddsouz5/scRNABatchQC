# Pairwise Difference

**This section identifies global pairwise difference across experiments. scRNABatchQC first detects differentially expressed genes between two experiments and then performs functional enrichment analysis on differentially expressed genes. Genes and pathways will help discriminate real biological effects from technical noise.**

<hr>


```{r plotDiffGenes, eval=drawDiffGenesHeatmap, echo=FALSE, warning=FALSE, message=FALSE, results='asis', fig.align="center", fig.cap=figRef("plotDiffGenes", "Heatmap of differentially expressed genes in pairwise comparison", trunk.eval=drawDiffGenesHeatmap), fig.height=getHeatmapHeight(plotData$scesMerge@metadata$diffFC$genes), fig.width=10}
plotHeatmap(as.matrix(plotData$scesMerge@metadata$diffFC$genes),"diffg")
```
```{r plotDiffGenesTable, eval=drawDiffGenesTable, echo=FALSE, warning=FALSE, message=FALSE, results='asis'}
plotHeatmap(as.matrix(plotData$scesMerge@metadata$diffFC$genes),"diffg")
```

scRNABatchQC detects differentially expressed genes between two experiments (logFC>`r plotData$scesMerge@metadata$logFC` & FDR<`r plotData$scesMerge@metadata$FDR`). 

```{r diffgenes, echo=FALSE, warning=FALSE, message=FALSE, results='asis'}
if(hasDiffGenes){
  if(drawDiffGenesHeatmap){
    cat(figRef("plotDiffGenes"))
  }else{
    cat(tabRef("diffg"))
  }
  cat(" shows the log2 fold change of differentially expressed genes in each pairwise comparison.")
}else{
  cat("But no differentially expressed gene detected.")
}
```
